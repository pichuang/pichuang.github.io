
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open Knowledge, Open Source, Open Mind">
      
      
        <meta name="author" content="Phil Huang">
      
      
        <link rel="canonical" href="https://blog.pichuang.com.tw/20200713-bm-and-vm-container-deployment-consideration.html">
      
      
        <link rel="prev" href="20200529-openshift-etcd-operator-2.html">
      
      
        <link rel="next" href="20200828-kubectl-view-allocations.html">
      
      
        
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="feed_rss_updated.xml">
      
      <link rel="icon" href="favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3+insiders-4.49.2">
    
    
      
        <title>Kubernetes éƒ¨ç½²åœ¨è™›æ©Ÿå¥½é‚„æ˜¯è£¸æ©Ÿå¥½? - Phil's Workspace</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.67c3bdf0.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7COverpass+Mono+SemiBold:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Overpass Mono SemiBold"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-8MQRY98QB2"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-8MQRY98QB2",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-8MQRY98QB2",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
              </button>
            
            
  <a href="https://www.youtube.com/@pichuang-tw" style="color:white;">
    For updates follow <strong>@pichuang-tw</strong> on
    <strong>YouTube Channel ğŸ¥ </strong>
  </a>

          </div>
          
            <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Phil&#39;s Workspace" class="md-header__button md-logo" aria-label="Phil's Workspace" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.97 5.92a.967.967 0 0 0-1.18-.68l-3.4.91-4.44-4.12-1.23.33 2.66 4.59-3.19.85-1.26-.98-.93.25 1.66 2.88 10.62-2.84c.52-.15.82-.68.69-1.19M21 10l-1 2h-5l-1-2 1-1h2V7h1v2h2l1 1m1 10v2H2v-2h13v-7h5v7h2Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phil's Workspace
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kubernetes éƒ¨ç½²åœ¨è™›æ©Ÿå¥½é‚„æ˜¯è£¸æ©Ÿå¥½?
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pichuang/pichuang.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    blog.pichuang.com.tw
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="wiki/index.html" class="md-tabs__link">
          
  
    
  
  Wiki

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="azure-subnets.html" class="md-tabs__link">
          
  
    
  
  Azure Visual Subnet Calculator

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="about.html" class="md-tabs__link">
          
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Phil&#39;s Workspace" class="md-nav__button md-logo" aria-label="Phil's Workspace" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.97 5.92a.967.967 0 0 0-1.18-.68l-3.4.91-4.44-4.12-1.23.33 2.66 4.59-3.19.85-1.26-.98-.93.25 1.66 2.88 10.62-2.84c.52-.15.82-.68.69-1.19M21 10l-1 2h-5l-1-2 1-1h2V7h1v2h2l1 1m1 10v2H2v-2h13v-7h5v7h2Z"/></svg>

    </a>
    Phil's Workspace
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pichuang/pichuang.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    blog.pichuang.com.tw
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="2024.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="2023.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="2022.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="2021.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2021
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="2020.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="2019.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2019
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="ansible.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ansible
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="automation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="azure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    azure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="container.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    container
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="homecloud.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    homecloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="kubernetes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="linux.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="misc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    misc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="networking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="o11y.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    o11y
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="openai.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    openai
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="openshift.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    openshift
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="personal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    personal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="sla.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    sla
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="sustainability.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    sustainability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    
  
    Authors
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Authors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="author/url.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Phil Huang
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="wiki/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Wiki
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Wiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    
  
    Azure Visual Subnet Calculator
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Azure Visual Subnet Calculator
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="azure-subnets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Visual Subnet Calculator (Azure Edition)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="about.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Who is Phil Huang?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="recording.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Recording
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="index.html" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://avatars.githubusercontent.com/u/5253671" alt="Phil Huang">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          <a href="https://blog.pichuang.com.tw">Phil Huang</a>
                        
                      </strong>
                      <br>
                      Microsoft Senior Cloud Solution Architect | CNCF Ambassador
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2020-07-13 00:00:00" class="md-ellipsis">20200713</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="kubernetes.html">kubernetes</a></span>
                        </div>
                      </li>
                    
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
            

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4 å€‹å…ˆå‚™å°çŸ¥è­˜
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 å€‹å…ˆå‚™å°çŸ¥è­˜">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#containers-are-linux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Containers are Linux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-is-a-container-orchestration-platform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kubernetes is a Container Orchestration Platform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-pod-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container è·Ÿ Pod è·Ÿ Kubernetes çš„é—œä¿‚
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kubernetes è³‡æºä¼°ç®—æ–¹å¼
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        å®¹å™¨éƒ¨ç½²åœ¨è™›æ“¬ç’°å¢ƒå¥½é‚„æ˜¯å¯¦é«”ç’°å¢ƒå¥½?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å®¹å™¨éƒ¨ç½²åœ¨è™›æ“¬ç’°å¢ƒå¥½é‚„æ˜¯å¯¦é«”ç’°å¢ƒå¥½?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        ç®¡ç†æ€§
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        è³‡æºéš”é›¢æ€§
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        é‹ç®—æ•ˆèƒ½
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        å…·å‚™ç‰¹æ®Šç¡¬é«”
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tco" class="md-nav__link">
    <span class="md-ellipsis">
      
        æ•´é«”æ“æœ‰æˆæœ¬ (TCO)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        çµèª
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
      
        <span class="md-tag">kubernetes</span>
      
    
  </nav>


  
  


<h1 id="kubernetes">Kubernetes éƒ¨ç½²åœ¨è™›æ©Ÿå¥½é‚„æ˜¯è£¸æ©Ÿå¥½?</h1>
<p>é€™å¹¾é€±å¸¸è¢«å•åˆ°ä¸€å€‹å•é¡Œ</p>
<blockquote>
<p>ä»¥æŠ€è¡“è§€é»ä¾†çœ‹ï¼Œè«‹å•å®¹å™¨ (Container) æˆ–è€…æ˜¯å®¹å™¨å¹³å° (Kubernetes) æ¯”è¼ƒé©åˆéƒ¨ç½²åœ¨è™›æ“¬ç’°å¢ƒ (VM) ä¸­é‚„æ˜¯è£¸æ©Ÿç’°å¢ƒä¸­ (Bare Metal)?</p>
</blockquote>
<p><img alt="" src="/images/vm-vs-bm.jpg" /></p>
<p>å…¶å¯¦é€™å€‹å•é¡Œåœ¨åå¹´å‰è™›æ“¬æ©ŸæŠ€è¡“å‰›å‡ºä¾†çš„æ™‚å€™ï¼Œä¹Ÿè »å¤šäººåšéæ¶æ§‹åŠæ€§èƒ½æ¯”è¼ƒï¼Œæ™‚å…‰å¿«è½‰åˆ°ç¾åœ¨çš„å¹´ä»£ï¼Œä¾†åˆ°å®¹å™¨çš„ä¸–ä»£ï¼Œç›¸åŒçš„å•é¡Œä¹Ÿè¢«æ‹¿å‡ºä¾†è¨è«–ï¼Œæœ¬ç¯‡å°±æ˜¯è¦ç‰¹åˆ¥è¬›è¿°ä¸€ä¸‹é—œæ–¼é€™äº›æ¶æ§‹ä¸Šçš„æ¯”è¼ƒåˆ†æã€ä½¿ç”¨å½±éŸ¿åŠå»ºè­°æ¡ç”¨çš„ç­–ç•¥ä½œæ³•å»ºè­°ï¼Œé€™ç¯‡æœƒæ¡ç”¨æ¯”è¼ƒä¸­ç«‹çš„è§’åº¦é—¡è¿°ï¼Œå¦‚æœæœ‰è§€é»å¤ªåé —çš„åœ°æ–¹ï¼Œå¯ä»¥ç§ä¸‹è·Ÿæˆ‘èªªåŠæä¾›ä¿®æ”¹å»ºè­°</p>
<p>ä¸å…ä¿—çš„æˆ‘é‚„æ˜¯è¦ä¾†è¬›ä¸€ä¸‹æœ¬æ¬¡æ–°ç™¼ç¾ï¼Œä¸‰å€‹æ„Ÿè¦ºä¸æœƒåŒæ¡†çš„å…¬å¸ Microsoft + Red Hat + HPE ä¸€èµ·å‡ºäº†æœ¬æ¶æ§‹æ›¸ <a href="https://h20195.www2.hpe.com/V2/GetDocument.aspx?docname=a50001963enw">HPE Reference Architecture for delivering insight across all your data with Microsoft SQL Server 2019 Big Data Clusters</a> æˆ‘è¦ºå¾—å¯¦åœ¨å¤ªç„äº† XD åˆ†äº«çµ¦å¤§å®¶</p>
<!--more-->

<h2 id="4">4 å€‹å…ˆå‚™å°çŸ¥è­˜</h2>
<p>åœ¨è¨è«–æ¶æ§‹ä¸Šçš„å„ªåŠ£ä¹‹å‰ï¼Œè¦å…ˆè·Ÿå„ä½æ¸…æ¥šåœ°è§£é‡‹é€™äº›æ¶æ§‹çš„å¯¦éš›é•·ç›¸æ˜¯æœ‰å“ªä¸€äº›</p>
<h3 id="containers-are-linux">Containers are Linux</h3>
<blockquote>
<p>A linux container is nothing more than a process that runs on Linux</p>
</blockquote>
<p><img alt="" src="/images/container-performance.png" /></p>
<p>ä¸€é–‹å§‹è¦å…ˆå°å®¹å™¨ (Container) é€²è¡Œåè©èªªæ˜ï¼Œå…¶å¯¦é€™å€‹å®¹å™¨é€™å€‹æŠ€è¡“æ²’ä»€éº¼ç‰¹åˆ¥çš„é»‘é­”æ³•ï¼Œä¹Ÿä¸æ˜¯ç›¸ç•¶å‰è¡›çš„æ±è¥¿ï¼ŒæŠ€è¡“æœ¬è³ªä¸Šå°±æ˜¯ä¸€å€‹æˆ–å¤šå€‹ Linux Process çš„å‘ˆç¾ï¼Œæ˜¯çš„ï¼ä½ éå¾€ä½¿ç”¨çš„ chroot / LXC / Jail çš†å±¬é€™é¡ï¼Œæ‰€ä»¥ä½ éå¾€èƒ½å° Linux Process é€²è¡Œä¸€äº›æ·±åº¦æ§åˆ¶çš„æ–¹å¼ï¼Œè­¬å¦‚åƒæ˜¯ secompã€cgroupsã€selinux ç­‰æ“ä½œï¼Œéƒ½èƒ½åœ¨ Container è£¡é¢å‘ˆç¾ï¼Œæ›´ç”šè‡³æ˜¯å¸¸è¦‹çš„ Linux Performance Obsevability Tools æ•ˆèƒ½é‡æ¸¬å·¥å…·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œå¯¦å‹™ä¸Šå¯ä»¥åƒè€ƒ <a href="https://github.com/nicolaka/netshoot">nicolaka/netshoot - a Docker + Kubernetes network trouble-shooting swiss-army container</a></p>
<p>åŸºæ–¼ä»¥ä¸Šçš„ç†ç”±ï¼Œæ‰€ä»¥æœ‰æ™‚å€™ä½ æœƒçœ‹åˆ°ä¸‹åˆ—å¹¾ç¨®èªªæ³•</p>
<ul>
<li>Container Security is Linux Security</li>
<li>Container Performance is Linux Performance</li>
<li>Container Reliability is Linux Reliability</li>
</ul>
<p><img alt="" src="/images/linux-arch.png" /></p>
<p>çµè«–å°±æ˜¯ï¼Œä½ çš„å®¹å™¨ç©©ä¸ç©©å®šã€å®‰ä¸å®‰å…¨è·Ÿä½ æ‰€ä½¿ç”¨çš„ä½œæ¥­ç³»çµ±å…¶å¯¦æ˜¯æœ‰ 100% çš„é—œä¿‚</p>
<h3 id="kubernetes-is-a-container-orchestration-platform">Kubernetes is a Container Orchestration Platform</h3>
<p><img alt="" src="/images/k8s-arch.png" /></p>
<blockquote>
<p>Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications.</p>
</blockquote>
<p>å¾ <a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">What is Kubernetes?</a> å¯çŸ¥ï¼Œæ‡‰ç”¨ç¨‹å¼é€éå®¹å™¨éƒ¨ç½²æ–¹å¼æ‰€å¸¶ä¾†çš„å„ªå‹¢ï¼Œå…·å‚™è¼•é‡ç´šè³‡æºéš”é›¢æ–¹å¼ã€å¯å…±ç”¨ä½œæ¥­ç³»çµ±åŠè³‡æºå¯é«˜æ•ˆç‡åŠå¯†é›†ä½¿ç”¨ç­‰çœ¾å¤šå¥½è™•ï¼Œä½†ç•¶æˆ‘çš„ Container æ•¸é‡ä¸€å¤šï¼Œæœå‹™è®Šå¾—æ›´å¤§æ›´å¤šçš„æ™‚å€™ï¼Œèª°èƒ½è² è²¬å¹«é€™äº› Container æ‰¾åˆ°ä¸€å€‹é©åˆçš„åœ°æ–¹é‹è¡Œã€æŒçºŒçš„ç›£æ§åŠæ•…éšœè™•ç†? æ‰€ä»¥é€™æ™‚å€™ä½ æœƒéœ€è¦ä¸€å€‹<code>è² è²¬ç®¡ç†å®¹å™¨é‹è¡Œçš„æ§åˆ¶å¹³å°</code>ï¼Œä¹Ÿå°±æ˜¯ç¾ä»Šæœ€ç†±é–€çš„ Kubernetesã€‚</p>
<p>Kubernetes å®¹å™¨å¹³å°å…§å»ºå¤šç¨®å”åŠ©ç®¡ç†å®¹å™¨çš„æ©Ÿåˆ¶ï¼ŒåŒ…å«ä½†ä¸é™æ–¼ï¼š</p>
<ol>
<li>å…§éƒ¨æœå‹™ç™¼ç¾å’Œè² è¼‰å‡è¡¡</li>
<li>æå‡ºçµ±ä¸€ä¸”æ¨™æº–çš„è²æ˜å¼ (Declarative) APIï¼šé€™é»æ‡‰è©²æ˜¯ Kubernetes èª•ç”Ÿå¾Œï¼Œå°æ–¼æ•´å€‹ IT ç•Œæœ€å¤§çš„å½±éŸ¿äº†ï¼Œæœ‰èˆˆè¶£æƒ³äº†è§£æ›´å¤šçš„å¯ä»¥åƒè€ƒæ­¤æ–‡ <a href="https://yq.aliyun.com/articles/713012">äº‘åŸç”Ÿæ—¶ä»£ï¼Œ Kubernetes å¤šé›†ç¾¤æ¶æ„åˆæ¢</a>ï¼Œé€™ç¯‡çœŸçš„å¯«å¾—ä¸éŒ¯</li>
<li>å…§å»ºè‡ªæˆ‘ä¿®å¾©å®¹å™¨èƒ½åŠ›ï¼šæ‰¿ä¸Šï¼ŒKubernetes ä¸­çš„è²æ˜å¼ API å…¶å¯¦å°±æ˜¯<em>æŒ‡å®šè©²å¢é›†æ‰€æœŸæœ›çš„é‹è¡Œç‹€æ…‹</em>ï¼Œæ‰€ä»¥å‡ºç¾ä»»ä½•ä¸ä¸€è‡´çš„ç‹€æ…‹çš„æ™‚å€™ï¼ŒKubernetes å¯ä»¥è‡ªè¡Œé€éæŒ‡å®šçš„ YAML æ–‡ä»¶æè¿°ï¼Œä¾†é€²è¡Œç‹€æ…‹é·ç§»ï¼Œä½œå‡ºåˆé©æ–¼ç•¶ä¸‹ç’°å¢ƒçš„æ“ä½œ</li>
<li>æ˜“æ–¼è³‡æºæ©«å‘æ“´å……ï¼šä»¥ Kubernetes çš„è§’åº¦é€²è¡Œçš„å®¹å™¨ç·¨æ’ï¼Œå·²ç¶“å°‡ä¸Šå±¤æœå‹™è·Ÿåº•å±¤åŸºç¤è¨­æ–½è„«é›¢æ›é‰¤ï¼ŒIT äººå“¡åƒ…éœ€é—œå¿ƒ Kuerbernets æ‰€æº–å‚™çš„è³‡æºå¤ ä¸å¤ ä¸Šå±¤æœå‹™ä½¿ç”¨ï¼Œé€²è€Œå½¢æˆä¸€å€‹è³‡æºæ±  (Resource Pool) çš„è§€å¿µï¼ŒåŒ…å« CPU Pool / Memory Pool / Storage Pool</li>
<li>å¯è·¨è£¸æ©Ÿã€è™›æ“¬ç’°å¢ƒã€å…¬ç§æœ‰é›²ä¸Šä½¿ç”¨ï¼šå…¶å¯¦é€™å€‹çœŸæ­£çš„ç†ç”±æ˜¯å› ç‚ºä½œæ¥­ç³»çµ±çš„é—œä¿‚ï¼Œå› ç‚º Kubernetes çš„é‹ä½œæ˜¯åŸºæ–¼åœ¨ä½œæ¥­ç³»çµ±ä¹‹ä¸Šï¼Œæ‰€ä»¥åªè¦ç¢ºä¿èƒ½åœ¨ä½œæ¥­ç³»çµ±èƒ½åœ¨ä»»ä¸€ç’°å¢ƒå•Ÿå‹•å³å¯ä½¿ç”¨</li>
</ol>
<p>è€Œè¦è®“ Kubernetes æ§åˆ¶å¹³å°æœ‰é€™äº›èƒ½åŠ›å¿…ç„¶æœƒéœ€è¦å¦å¤–å®‰è£ä¸€äº›æ‰€éœ€è¦çš„è»Ÿé«”ï¼Œè­¬å¦‚èªªæ¯ä¸€å€‹ Worker å¿…ç„¶æœƒéœ€è¦å®‰è£çš„ä½œæ¥­ç³»çµ±ã€kubeletã€CNI ç¶²è·¯å¥—ä»¶ç­‰ä¸€äº›å¸¸é§è»Ÿé«”ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¾†è¬›æœ€çµ‚èƒ½ä¾›æ‡‰ç”¨ç¨‹å¼æ‰€ä½¿ç”¨çš„è³‡æºä¸å…¨ç„¶æ˜¯ç­‰åŒæ–¼å¤–é¢çš„è¦æ ¼ï¼Œæ‰€ä»¥é‡å° Kubernetes å¹³å°å»ºç½®æ‰æœƒæœ‰ä¸€ç¨®è¶¨å‹¢æ˜¯<code>ä½œæ¥­ç³»çµ±ç›¡é‡ç²¾ç°¡åˆ°åƒ…éœ€å¯ä»¥ä¹˜è¼‰å®¹å™¨é‹ä½œå³å¯ï¼Œå…¶ä»–å¤šé¤˜çš„éƒ½å¯ä»¥æ‹¿æ‰ï¼Œä»¥é”åˆ°æœ€å¤§è³‡æºåˆ©ç”¨ç‡</code>ï¼Œé€²è€Œèª•ç”Ÿå„å¼å„æ¨£çš„<code>å®¹å™¨ä½œæ¥­ç³»çµ± (Container OS)</code> ä¾›å¤§å®¶é¸æ“‡ä½¿ç”¨</p>
<p>è‹¥æƒ³è¦äº†è§£ CPU å’Œ Memory çš„è³‡æºé…ç½®æ–¹å¼å¯ä»¥åƒè€ƒåœ–æ–‡ä¸¦èŒ‚çš„ <a href="https://learnk8s.io/allocatable-resources">Allocatable memory and CPU in Kubernetes Nodes - learnk8s</a></p>
<h3 id="container-pod-kubernetes">Container è·Ÿ Pod è·Ÿ Kubernetes çš„é—œä¿‚</h3>
<p><img alt="" src="/images/container-pod-k8s.png" /></p>
<p>é¦–å…ˆæ˜¯ï¼ŒPod è·Ÿ Kubernetes</p>
<blockquote>
<p>Pods are the smallest deployable units in Kubernetes</p>
</blockquote>
<p>åœ¨ Kubernetes çš„ä¸–ç•Œè£¡ï¼Œæœ€å°èª¿åº¦å–®ä½æ˜¯ <code>Pod</code>ï¼Œè€Œä¸æ˜¯ Containerï¼Œé€™é»ç›¸ç•¶é‡è¦ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰€çŸ¥é“çš„è³‡æºèª¿åº¦åŠæ‡‰ç”¨ç¨‹å¼è¤‡è£½ï¼Œå…¨éƒ¨éƒ½æ˜¯ä»¥ Pod ç‚ºè§’åº¦æ€è€ƒè€Œä¸æ˜¯ä»¥å–®ã„§ Container ç‚ºä¸»ï¼Œé‚£æœ‰äººå°±æœƒå•é‚£ Container è·Ÿ Pods çš„é—œä¿‚åˆæ˜¯ä»€éº¼?</p>
<blockquote>
<p>A Pod is a group of one of more containers with shared storage and network</p>
</blockquote>
<p>åœ¨ Kubernetes æ‰€å®šç¾©æœ€å°å–®ä½ <code>Pod</code> ç•¶ä¸­ï¼Œå¯ä»¥<code>å­˜åœ¨ 1 å€‹æˆ–å¤šå€‹</code>çš„ Container é‹è¡Œåœ¨å…¶ä¸­ï¼Œä¸¦ä¸”å…±é€šåˆ†äº«åŒä¸€å€‹ Linux Namespace æ‰€æä¾›çš„è³‡æºï¼Œåªè¦åœ¨åŒä¸€å€‹ Pod è£¡é¢å…§ï¼ŒContainer äº’ç›¸çš„è³‡æºçš†å¯ä»¥è¢«å­˜å–ï¼Œç„¶è€Œé€™äº› Container æ‰æ˜¯å¯¦éš›ä¸ŠåŒ…è£æ‡‰ç”¨ç¨‹å¼å¾Œæ‰€å‘ˆç¾çš„æ¨£æ…‹ï¼Œé‹è¡Œçš„ç’°å¢ƒæ¯«ä¸æ‡·ç–‘åœ°å°±æ˜¯è·‘åœ¨ä½œæ¥­ç³»çµ±ä¸Šé¢</p>
<p>æœ‰äº›äººæœƒå¾ˆå¥½å¥‡ç‚ºä»€éº¼å¾ˆå¤šæ™‚å€™éƒ½æœƒæŠŠ Pod è·Ÿ Container æ··åœ¨ä¸€èµ·æè¿°å‘¢? é€™æ˜¯å› ç‚ºçµ•å¤§éƒ¨åˆ†çš„å¯¦ä½œï¼Œä¸€å€‹ Pod è£¡é¢åƒ…æœƒæ”¾ç½®ä¸€å€‹ Container åœ¨è£¡é¢ï¼Œæ‰€ä»¥æ‰æœƒæœ‰é€™ç¨®éŒ¯è¦ºç”¢ç”Ÿ</p>
<h3 id="kubernetes_1">Kubernetes è³‡æºä¼°ç®—æ–¹å¼</h3>
<p>æ ¹æ“š <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Managing Resources for Containers - Kubernetes</a>ï¼Œä½ æœƒçŸ¥é“å…¶æ‰€å®šç¾©çš„ Resource Type ä¸»è¦æœ‰ä¸‹åˆ—å…©å€‹ï¼š</p>
<ol>
<li>CPU</li>
<li>Memory</li>
</ol>
<blockquote>
<p>One cpu, in Kubernetes, is equivalent to 1 vCPU/Core for cloud providers and 1 hyperthread on bare-metal Intel processors.</p>
</blockquote>
<p>å‰è€… CPU çš„æ›ç®—æ–¹å¼ï¼Œå°±æ˜¯ <code>1 CPU = 1 Core = 1,000 millicores = 1,000m</code>ï¼Œæ˜¯æ¡ç”¨<code>çµ•å°æ•¸é‡</code>ä¾†é€²è¡Œè¨ˆç®—ï¼ŒKubernetes è¦æ±‚ 0.1 Core å°±æ˜¯éœ€è¦å®Œå®Œæ•´æ•´çš„ 0.1 Coreï¼Œç„¡è«–åº•ä¸‹ CPU æ˜¯ Single Coreã€Dual-Coreã€32 Core æ©Ÿå™¨ï¼Œé‚„æ˜¯é€é CPU Overcommitment èª¿æ•´å¾Œï¼Œä¸” Kubernetes è¨ˆç®—è³‡æºæ™‚ä¹Ÿç„¡è¦–æ™‚è„ˆé »ç‡ (clock rate) çš„å·®ç•°ï¼Œä¸‹åˆ—ç‰¹åˆ¥åˆ—èˆ‰å‡ºæ‰€æœ‰è·Ÿ Kubernetes 1 CPU æ‰€ç­‰åƒ¹çš„è³‡æºæ¸…å–®ï¼Œç„¶è€Œä¸€èˆ¬åš CPU è³‡æºè¨ˆç®—çš„æ™‚å€™éƒ½æœƒä»¥ vCPU è§’åº¦é€²è¡Œè¨ˆç®—</p>
<table>
<thead>
<tr>
<th>1 Kubernetes CPU is equivalent to</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 Hyperthread on a bare-metal Intel processor with Hyperthreading</td>
</tr>
<tr>
<td>1 vSphere CPU</td>
</tr>
<tr>
<td>1 IBM vCPU</td>
</tr>
<tr>
<td>1 Azure vCore</td>
</tr>
<tr>
<td>1 GCP Core</td>
</tr>
<tr>
<td>1 AWS vCPU</td>
</tr>
<tr>
<td>1 Non-HT CPU</td>
</tr>
</tbody>
</table>
<p>å¾Œè€… Memory çš„è¨ˆç®—æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨äºŒé€²ä½è¡¨ç¤ºæˆ–è€…æ˜¯åé€²ä½è¡¨ç¤ºï¼Œä¾‹å¦‚ä¸‹åˆ— 3 å€‹æ•¸å€¼æ˜¯ç­‰åƒ¹é—œä¿‚ï¼š</p>
<blockquote>
<p>128974848 = 123 Mi (power of 2) = 129 M (power of 10)</p>
</blockquote>
<p>å¦å¤–å®ƒä¹Ÿæ˜¯æ¡ç”¨<code>çµ•å°æ•¸é‡</code>ä¾†é€²è¡Œè¨ˆç®—ï¼Œç„¡è«–ä½ åº•ä¸‹æ˜¯å¯¦é«”è¨˜æ†¶é«”é‚„æ˜¯è™›æ“¬è¨˜æ†¶é«”ï¼Œæˆ–è€…æ˜¯æœ‰ç¶“ VMM å¹³å°æ‰€æä¾›çš„ Memory overcommitment èƒ½åŠ›æ“´å¼µå¾Œçš„æ•¸å­—ï¼Œä¸€èˆ¬å¾ˆå°‘é‡åˆ°é€™é¡å•é¡Œæ˜¯å› ç‚ºå¤§å¤šæ•¸çš„äººçš„è¨˜æ†¶é«”ç”¨æ³•éƒ½æ˜¯ 1:1 é€²è¡Œä½¿ç”¨ï¼Œç„¶è€Œåš Memory è³‡æºè¨ˆç®—çš„æ™‚å€™ï¼Œå»ºè­°éƒ½ä»¥ vRAM è§’åº¦é€²è¡Œè¨ˆç®—</p>
<table>
<thead>
<tr>
<th>1 Kubernetes memory is equivalent to</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 physical RAM</td>
</tr>
<tr>
<td>1 virtual RAM</td>
</tr>
</tbody>
</table>
<h2 id="_1">å®¹å™¨éƒ¨ç½²åœ¨è™›æ“¬ç’°å¢ƒå¥½é‚„æ˜¯å¯¦é«”ç’°å¢ƒå¥½?</h2>
<p>è‹¥ä½ æœ‰èªçœŸæŠŠä¸Šé¢çš„ 4 å€‹å…ˆå‚™å°çŸ¥è­˜çœ‹å®Œä¹‹å¾Œï¼Œç†æ‡‰æœƒæœ‰ä¸‹åˆ—çµè«–</p>
<ol>
<li>å®¹å™¨å¿…ç„¶æœƒé‹è¡Œæ–¼ä½œæ¥­ç³»çµ±ä¹‹ä¸Š</li>
<li>Kubernetes çš„é‹è¡Œæ˜¯å»ºç«‹æ–¼ä½œæ¥­ç³»çµ±ä¹‹ä¸Šï¼Œå…¶æœ¬èº«é‚„æ˜¯éœ€è¦æ¶ˆè€—ä¸€å®šçš„è³‡æºé‹ä½œ</li>
<li>Kubernetes å°æ–¼è³‡æºçš„åˆ©ç”¨æ˜¯ç„¡è¦–è™›æ“¬ç’°å¢ƒã€å¯¦é«”ç’°å¢ƒ</li>
</ol>
<p>é¦–å…ˆå…ˆæŠŠæ‰€æœ‰å¸¸è¦‹ç’°å¢ƒæ¶æ§‹æ“ºåœ¨ä¸€èµ·ï¼ŒåŒ…å«ä¸‹åˆ— 4 ç¨®ï¼š</p>
<p><img alt="" src="/images/4-compare.png" /></p>
<ol>
<li>Bare Metal</li>
<li><code>Container on Bare Metal</code></li>
<li>VM on Bare Metal</li>
<li><code>Container on VM on Bare Metal</code></li>
</ol>
<p>ç•¶ä¸­ 2ã€Container on Bare Metal è·Ÿ 4ã€Container on VM on Bare Metal æ˜¯æœ¬æ–‡éœ€è¦è¨è«–çš„æ¶æ§‹ï¼Œä¸€èˆ¬éœ€è¦è€ƒé‡å®¹å™¨æ˜¯å¦è¦ä¸è¦æ”¾åœ¨è™›æ“¬ç’°å¢ƒå’Œå¯¦é«”ç’°å¢ƒï¼Œæœƒæœ‰ä»¥ä¸‹ 5 å¤§è€ƒé‡é»</p>
<ol>
<li>ç®¡ç†æ€§</li>
<li>è³‡æºéš”é›¢æ€§</li>
<li>é‹ç®—æ•ˆèƒ½</li>
<li>æ˜¯å¦å…·å‚™ç‰¹æ®Šç¡¬é«”</li>
<li>æ•´é«”æ“æœ‰æˆæœ¬</li>
</ol>
<h3 id="_2">ç®¡ç†æ€§</h3>
<p><img alt="" src="/images/pets-cattle.jpeg" /></p>
<p>å¦‚æœä½ æ˜¯è™›æ“¬æ©Ÿç’°å¢ƒä½¿ç”¨ç‚ºä¸»çš„ç¶­é‹äººå“¡ï¼Œå°±è§’åº¦ä¸Šä¾†èªªï¼ŒKubernetes å°±æ˜¯ä¸€ç¾¤ VM æ‰€çµ„æˆçš„ï¼Œæ‰€ä»¥æ—¢æœ‰çš„ VM ç®¡ç†æ–¹å¼æˆ–åŠŸèƒ½é‚„æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè­¬å¦‚èªª Overcommitmentã€Snapshotã€è™›æ“¬ç¶²è·¯å¡æ–°ä¿®åˆªã€Migrationï¼Œä½†é€™äº›åŠŸèƒ½å°æ–¼ Kubernetes æœ¬èº«é‹ä½œä¾†è¬›ä¸¦ä¸æ˜¯å¿…è¦çš„é¸é …ï¼Œæ­¸å±¬æ–¼æŠ€è¡“å¯ä»¥å¯¦ç¾ä½†ä¸¦ä¸æ˜¯å¿…è¦çš„é¡åˆ¥ï¼Œæ¯”è¼ƒå¸¸è¦‹çš„è¨è«–å°±æ˜¯åœ¨ VM Migration èƒ½åŠ›éœ€è¦èˆ‡å¦ï¼Œä»¥ Kubernetes ä¾†è¬›ï¼Œé€éå…§å»ºçš„ Self Healing æˆ–è€…æ˜¯ Node Selector çš„åšæ³•ï¼Œå¯ä»¥è¼•æ˜“çš„è¾¦åˆ°è·¨ç¯€é»é‹è¡Œç›¸åŒç¨‹å¼çš„éœ€æ±‚</p>
<p>å€˜è‹¥æ˜¯ä»¥è£¸æ©Ÿç’°å¢ƒç‚ºä¸»çš„ç¶­é‹äººå“¡ï¼Œå› ç‚ºè£¸æ©Ÿä¸Šé¢ç›´æ¥å¥—ç”¨ä½œæ¥­ç³»çµ±ï¼Œå¯ä»¥ç›¸ç•¶ç„¡è…¦åœ°åŠ å…¥å…¨æ©Ÿè³‡æºè½‰æ›æˆ Worker Node æä¾›çµ¦ Kubernetes åŠ å…¥ç•¶ä¸­çš„è¨ˆç®—è³‡æºæ± å…§ä½¿ç”¨ï¼Œä¸”æ‰€æœ‰ç®¡ç†æ“ä½œçš†ç”± Kubernetes æ§åˆ¶ç¯€é»çµ±ä¸€ç®¡ç†ï¼Œç›¸å°ä¾†èªªæ¸›å°‘äº†æ‰€éœ€ç®¡ç†çš„å±¤æ•¸ï¼Œå¯ä»¥é€éè¼ƒå°‘çš„ç¡¬é«”ä¾†é‹è¡Œç›¸åŒæ•¸é‡çš„å®¹å™¨</p>
<p>çµè«–æ˜¯ï¼Œå¦‚æœä½ æƒ³è¦æ²¿ç”¨æ—¢æœ‰è™›æ“¬ç’°å¢ƒçš„ç®¡ç†å„ªå‹¢ï¼Œè€Œä¸è€ƒæ…®å„ªå…ˆä½¿ç”¨ Kubernetes å…§å»ºç®¡ç†æ©Ÿåˆ¶ï¼Œéƒ¨ç½²å®¹å™¨è‡³è™›æ“¬ç’°å¢ƒæ˜¯æ¯”è¼ƒå¥½çš„é¸æ“‡ï¼›åä¹‹ï¼Œä½ æƒ³è¦å®Œå…¨ä½¿ç”¨ Kubernetes å…§å»ºæ‰€å¸¶ä¾†çš„ç®¡ç†æ©Ÿåˆ¶ï¼Œéƒ¨ç½²å®¹å™¨è‡³è£¸æ©Ÿç’°å¢ƒæ˜¯æœ€ä½³é¸</p>
<h3 id="_3">è³‡æºéš”é›¢æ€§</h3>
<p><img alt="" src="/images/container-vm-isolation.png" /></p>
<p>ç„¡è«–æ˜¯ VM åŠ Container å…¶å¯¦çš†æœ‰æä¾›è³‡æºéš”é›¢èƒ½åŠ›çµ¦æ‡‰ç”¨ç¨‹å¼ï¼Œåªæ˜¯æŠ€è¡“è§’åº¦ä¸ä¸€æ¨£ã€‚</p>
<p>è‹¥æ˜¯ä»¥è£¸æ©Ÿç’°å¢ƒä¾†èªªï¼Œå› ç‚ºæ•´å°æ©Ÿå™¨è³‡æºåŠæ§åˆ¶æ¬Šéƒ½äº¤çµ¦äº† Host OSï¼Œæ‰€ä»¥ä½œæ¥­ç³»çµ±çš„å®‰å…¨æ€§æœƒç›´æ¥å½±éŸ¿åˆ°åº•å±¤ç¡¬é«”çš„å®‰å…¨æ€§èˆ‡å¦ï¼ŒåŒæ™‚å†æ­é…ä¸Š Container æœ¬èº«è‡ªå¸¶çš„è³‡æºéš”é›¢å‘½åç©ºé–“ - Linux Namespaces åŠå…¶ç›¸é—œçš„æ§åˆ¶èƒ½åŠ› seccompã€selinuxã€cgroups ç­‰æä¾› <code>Linux Process ç´šåˆ¥</code>ä¹‹è¼•é‡ç´šè³‡æºéš”é›¢</p>
<p>ä»¥è™›æ“¬ç’°å¢ƒ VMM Type 1 çš„æ¶æ§‹ç‚ºä¸»ï¼Œè™›æ“¬æ©Ÿå…·å‚™å®Œæ•´çš„ä½œæ¥­ç³»çµ±ï¼ŒåŒ…å«è¨˜æ†¶é«”ç®¡ç†å’Œè™›æ“¬è¨­å‚™é©…å‹•ç¨‹å¼ï¼Œä¸»è¦æ–¼<code>è™›æ“¬æ©Ÿç´šåˆ¥</code>æä¾›éš”é›¢èƒ½åŠ›ï¼Œä¸¦ç‚º Guest OS æä¾›æ“¬çœŸè³‡æºï¼Œå¯ä»¥é˜»æ­¢è™›æ“¬æ©ŸåŸ·è¡Œå¯èƒ½æå®³ä¸»æ©Ÿå¹³å°å®Œæ•´æ€§çš„æŒ‡ä»¤ï¼Œé€™ç¨®æ¶æ§‹æƒ³ç•¶ç„¶è€Œæ˜¯å°ä¸»æ©Ÿè³‡æºéœ€è¦æœ‰è¼ƒå¤§çš„è¦æ±‚ï¼Œä¾†é€²è¡Œå…¨è™›æ“¬åŒ–çš„ä¿è­·ï¼ŒåŒæ™‚é–“ä¹Ÿæ¡ç”¨äº† Container æœ¬èº«æ‰€å¸¶ä¾†çš„è³‡æºéš”é›¢èƒ½åŠ›ï¼Œåšåˆ°é›™é‡éš”é›¢</p>
<p><img alt="" src="/images/vm-coontainer.png" /></p>
<p>çµè«–æ˜¯ï¼Œå€˜è‹¥ä½ å–®å°è¨­å‚™æœ‰éœ€è¦è·Ÿåˆ¥çš„å–®ä½å…±ç”¨å·¥ä½œè² è¼‰ä¸”ä½œç‚ºä¸åŒç”¨é€”çš„è©±ï¼Œä¸”ä¸¦éæ˜¯å¯ä»¥é€éè¼•é‡ç´šéš”é›¢èƒ½åŠ›å¯ä»¥è¾¦åˆ°çš„è³‡æºéš”é›¢ï¼Œé‚£ä½¿ç”¨è™›æ“¬ç’°å¢ƒæ˜¯æ¯”è¼ƒå¥½çš„é¸æ“‡ï¼Œåä¹‹ï¼Œä½ æ˜¯å°ˆé–€æƒ³è¦æä¾›æŸå€‹æœå‹™æˆ–æŸå€‹éƒ¨é–€ï¼Œä¸¦æœªæœ‰å…±ç”¨å…¶ä»–å·¥ä½œè¦†è¼‰è­°é¡Œçš„è©±ï¼Œè£¸æ©Ÿç’°å¢ƒåŸºæœ¬ä¸Šæ˜¯æœ€ä½³é¸æ“‡</p>
<h3 id="_4">é‹ç®—æ•ˆèƒ½</h3>
<p><img alt="" src="/images/vm-bm-latency.png" /></p>
<blockquote>
<p>Performance: Native &gt; Container &gt; VM</p>
</blockquote>
<p>å…¶å¯¦é€™å€‹ä¸ç”¨ç‰¹åˆ¥è¨è«–ä¹Ÿå¯ä»¥ç†è§£åˆ°ï¼Œè£¸æ©Ÿæ•´é«”æ•ˆèƒ½æœƒæ¯”è™›æ“¬ç’°å¢ƒå¥½ï¼Œç•¢ç«Ÿè£¸æ©Ÿå…¨éƒ¨çš„è³‡æºéƒ½æ‹¿ä¾†ä½¿ç”¨ï¼Œé‡å°ç¶²è·¯çš„éƒ¨åˆ†ï¼Œé€™ç¯‡æ–‡ç«  <a href="https://www.ctl.io/developers/blog/post/kubernetes-bare-metal-servers">Kubernetes on Bare Metal: When Low Network Latency is Key</a>ï¼Œè¡¨æ˜ Network Latency å·®è·æ˜¯ 3 å€å·¦å³ï¼ŒCPU åˆ©ç”¨ç‡å·®è·å¤§æ¦‚æ˜¯ 10% - 15% å·¦å³</p>
<p>æœ‰äººæœƒå•èªªä¸€èˆ¬çš„ Kubernetes å£“åŠ›æ¸¬è©¦å¹³æ™‚éƒ½æ˜¯åœ¨ä»€éº¼ç’°å¢ƒå£“çš„? ç­”æ¡ˆæ˜¯ä¸»è¦æ˜¯åœ¨ä¸‰å¤§å…¬æœ‰é›²ä¸Šçš„ç’°å¢ƒï¼Œå› ç‚ºè¨ˆç®—è³‡æºå…¬æœ‰é›²éƒ½æº–å‚™å¥½äº†ï¼Œä¸»è¦æ¸¬è©¦ä¹Ÿæœƒä»¥é€™äº›å…¬æœ‰é›²çš„ç’°å¢ƒç‚ºä¸»ï¼Œæœ‰è¶£çš„äº‹æƒ…æ˜¯ä¸‰å¤§é›²æ‰€æä¾›çš„ç’°å¢ƒé›–ç„¶éƒ½æ˜¯ç›¸åŒçš„é‡ç´šçš„ CPU / Memoryï¼Œä½†ç«¯çœ‹æ¸¬è©¦çš„æ™‚å€™æœƒæœ‰æ•ˆèƒ½ä¸Šçš„é¡¯è‘—å·®ç•°</p>
<h3 id="_5">å…·å‚™ç‰¹æ®Šç¡¬é«”</h3>
<p><img alt="" src="/images/pci-passthough.gif" /></p>
<p>å€˜è‹¥ä½ æ˜¯éœ€è¦é‹è¡Œ GPU / SR-IOV NIC æˆ–è€…æ˜¯å…¶ä»–éœ€è¦é«˜æ€§èƒ½é‹ç®—æˆ–å°å¯¦é«”ç¶²å¡æœ‰ç‰¹æ®Šè¦æ±‚çš„ï¼Œå»ºè­°ä¸€å¾‹å°±æ˜¯é¸æ“‡è£¸æ©Ÿéƒ¨ç½²è·¯ç·šäº†ï¼Œé›–ç„¶è™›æ“¬ç’°å¢ƒå¯ä»¥é€é PCI Passthough é€²è¡Œç©¿é€ä½¿ç”¨ï¼Œä½†ç¾è¡Œæ–¼ Kubernetes çš„ä½¿ç”¨ä¸Šå¤§å¤šé‚„æ˜¯ç›´æ¥è£¸æ©Ÿç’°å¢ƒä½¿ç”¨ï¼Œé™¤äº†ç®¡ç†æ–¹ä¾¿ä»¥å¤–ï¼Œå…¶æ¬¡çš„åŸå› æ˜¯é€šå¸¸æœƒè£è¼‰ç‰¹æ®Šç¡¬é«”ï¼Œæ‰€éœ€è¦çš„è¨ˆç®—è³‡æºä¹Ÿæ˜¯ç›¸ç•¶å¤§çš„ï¼Œå¤§éƒ¨åˆ†å¸¸è¦‹æ–¼é†«ç™‚ã€è£½é€ ã€é›»ä¿¡ç­‰å°è¨ˆç®—éœ€æ±‚ç›¸å°å¤§çš„é ˜åŸŸ</p>
<h3 id="tco">æ•´é«”æ“æœ‰æˆæœ¬ (TCO)</h3>
<p>å¾ <a href="https://climbcsblog.com/2019/03/11/five-reasons-you-should-run-containers-on-bare-metal-not-vms/">Five Reasons You Should Run Containers on Bare Metal, not Virtual Machines</a> å€Ÿåœ–</p>
<p><img alt="" src="/images/tco.png" /></p>
<blockquote>
<p>ä¼ºæœå™¨æ‰€èƒ½æä¾›çš„è³‡æºä¸Šé™å°±æ˜¯å®Œå…¨ä¾æ“šç¡¬é«”è¦æ ¼æ‰€æä¾›çš„ï¼Œä¸¦ä¸æœƒå¤šä¹Ÿä¸æœƒå°‘</p>
</blockquote>
<p>æ–¼è™›æ“¬ç’°å¢ƒä¸­ï¼Œéœ€è¦å…ˆæ‰£é™¤æ‰ Host OS + é‹è¡Œ VMM Hypervisor Type 1 æ‰€éœ€è³‡æº + Guest OS é€™ä¸‰å¤§è¨ˆç®—è³‡æºä¹‹å¾Œï¼Œå‰©ä¸‹çš„æ‰æ˜¯å¯ç”¨è¨ˆç®—è³‡æºï¼ŒæŒ‰ç…§ <a href="https://blogs.vmware.com/apps/files/2019/11/Best-Practices-for-Red-Hat-OpenShift-on-the-VMware-SDDC-Final01.pdf">Best Practices for Red Hat OpenShift on the VMware SDDC - VMware</a> æ‰€è¿°ï¼Œç´„ç•¥æœƒéœ€è¦å…ˆ<code>ä¿ç•™ 15%</code>çš„è³‡æºä¾›è™›æ“¬ç’°å¢ƒå¹³å°ä½¿ç”¨ï¼›è€Œæ–¼è£¸æ©Ÿç’°å¢ƒä¸­ï¼Œå‰‡åƒ…éœ€æ‰£é™¤æ‰ Host OS çš„é‹ä½œè³‡æºå³å¯ï¼Œå¯ä»¥ç”¨æœ€å¤§å¹…åº¦å¯ç”¨è¨ˆç®—è³‡æºå»é‹è¡Œæœå‹™ï¼Œæ­£å¸¸ç‹€æ³ä¹‹ä¸‹ï¼Œæ¯å°ä¼ºæœå™¨èƒ½é‹è¡Œçš„å®¹å™¨æ•¸é‡ï¼Œè£¸æ©Ÿç’°å¢ƒæœƒæ¯”è™›æ“¬ç’°å¢ƒä¾†çš„é‚„è¦é«˜ï¼Œä¹Ÿæ„å‘³è‘—æ›´é«˜çš„åˆ©ç”¨ç‡ã€æ›´ä½çš„åŠŸè€—å’Œæ›´ä½çš„æˆæœ¬ã€è¿‘ä¸€æ­¥é™ä½ç®¡ç†è²»ç”¨</p>
<p>åŸºæ–¼è™›æ“¬ç’°å¢ƒçš„å®¹å™¨éƒ¨ç½²ä¸Šï¼Œæœ€å¤šçš„æˆæœ¬è€ƒæ…®å› ç´ æ˜¯è™›æ“¬åŒ–è»Ÿé«”æ‰€é™„å¸¶çš„æˆæœ¬è²»ç”¨ï¼Œç¨±ä½œ vTAXï¼Œé€šå¸¸éƒ¨ç½²ä¸Šæœƒé€£å¸¶ç”¢ç”Ÿç‚ºæ•¸å¯è§€çš„è²»ç”¨ï¼Œé€²è€Œå¢åŠ ç¸½é«”æ“æœ‰æˆæœ¬</p>
<p>çµè«–æ˜¯ï¼Œå€˜è‹¥ä½ æƒ³è¦æœ‰æœ€é«˜çš„ C/P å€¼çš„è©±ï¼Œåº•å±¤ç¡¬é«”å®Œå…¨æä¾›çµ¦å®¹å™¨é‹è¡Œçš„è©±ï¼Œè£¸æ©Ÿç’°å¢ƒéƒ¨ç½²æ˜¯æœ€ä½³é¸é …ï¼Œå…¶æ¬¡æ‰æ˜¯è™›æ“¬ç’°å¢ƒç‚ºä¸»</p>
<h2 id="_6">çµèª</h2>
<p>æœ€è¿‘è »å¤šå…¬å¸éƒ½åœ¨æ¨å»£ Kubernetes on Bare Metal çš„æ¶æ§‹ï¼Œä¾†ç²å¾—çš„è³‡æºæœ€å¤§ä½¿ç”¨æ•ˆç‡ã€æœ€ä½ TCOã€æœ€å¥½æ•ˆèƒ½ã€ç®¡ç†å–®ç´”ç­‰å¥½è™•ï¼Œå€˜è‹¥ä»Šå¤©æœ‰è€ƒæ…®è¦å»ºç«‹ä¸€å€‹åŸºæ–¼ Kubernetes ç‚ºä¸»çš„ç§æœ‰é›²æœå‹™ï¼Œé‚£çš„ç¢ºæ˜¯ä¸€å€‹è »å¥½çš„é¸æ“‡ï¼›å€˜è‹¥æ˜¯è¦è·Ÿæ—¢æœ‰çš„ç’°å¢ƒæ··ç”¨æˆ–è€…æ˜¯å› æ—¢æœ‰ç®¡ç†éœ€æ±‚ç­‰å› ç´ ï¼Œå‰‡å¯ä»¥è€ƒæ…®ä»¥ VM ç‚ºä¸»çš„ Kubernetes æœå‹™ï¼›ç•¶ç„¶é‚„æœ‰ä¸€ç¨®é¸æ“‡æ˜¯<code>æ··ç”¨</code>ï¼Œæˆ‘å€‹äººæ˜¯æ¯”è¼ƒæ¨å´‡é€™ç¨®æ¶æ§‹ï¼Œä¾æ“šæƒ…å¢ƒä¸åŒæä¾›ä¸åŒè³‡æºï¼Œç›¡å¯èƒ½çš„æœ‰æ•ˆåˆ©ç”¨å„æ¶æ§‹çš„å„ªå‹¢æˆªé•·è£œçŸ­</p>
<p><img alt="" src="/images/vmware-vs-k8s.png" /></p>
<p>ç¾å¯¦ç”Ÿæ´»ä¸­ï¼Œå¤§éƒ¨åˆ†çš„äººé‚„æ˜¯æœƒè©¢å•èªªï¼ŒVMware è·Ÿ Kubernetes çš„æ¶æ§‹å·®ç•°æ˜¯ä»€éº¼ï¼Œæˆ‘è¦ºå¾— VMware é€™ç¯‡æ¯”è¼ƒæ–‡ç« å¯«å¾—ä¸éŒ¯ <a href="https://blogs.vmware.com/cloudnative/2017/10/25/kubernetes-introduction-vmware-users/">Kubernetes Introduction for VMware Users â€“ Part 1: The Theory</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://searchservervirtualization.techtarget.com/tip/Bare-metal-vs-VM-container-deployment-considerations">Bare-metal vs. VM container deployment considerations</a></li>
<li><a href="https://climbcsblog.com/2019/03/11/five-reasons-you-should-run-containers-on-bare-metal-not-vms/">Five Reasons You Should Run Containers on Bare Metal, not Virtual Machines</a></li>
<li><a href="https://igene.tw/container-vs-vm#%E4%BD%BF%E7%94%A8%E6%99%82%E6%A9%9F">Container vs VM: When and Why? - Gene</a></li>
<li><a href="https://containerjournal.com/features/better-containers-bare-metal-virtual-machines/">Which is Better for Containers, Bare Metal or Virtual Machines?</a></li>
<li><a href="https://www.scitepress.org/papers/2018/66806/66806.pdf">Comparison Between Bare-metal, Container and VM using Tensorflow Image Classification Benchmarks for Deep Learning Cloud Platform - Paper</a></li>
<li><a href="https://lsalab.cs.nthu.edu.tw/home/publication/CLOSER18.pdf">Comparison Between Bare-metal, Container and VM using Tensorflow Image Classification Benchmarks for Deep Learning Cloud Platform - Slide</a></li>
<li><a href="https://www.openshift.com/blog/containers-are-linux">Containers are Linux</a></li>
<li><a href="https://medium.com/@jessgreb01/what-is-the-difference-between-a-process-a-container-and-a-vm-f36ba0f8a8f7">What is the difference between a process, a container, and a VM?</a></li>
<li><a href="https://github.com/nicolaka/netshoot">nicolaka/netshoot - GitHub</a></li>
<li><a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">What is Kubernetes?</a></li>
<li><a href="https://yq.aliyun.com/articles/713012">äº‘åŸç”Ÿæ—¶ä»£ï¼Œ Kubernetes å¤šé›†ç¾¤æ¶æ„åˆæ¢</a></li>
<li><a href="https://blogs.vmware.com/cloudnative/2017/10/25/kubernetes-introduction-vmware-users/">Kubernetes Introduction for VMware Users â€“ Part 1: The Theory</a></li>
<li><a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Managing Resources for Containers - Kubernetes</a></li>
<li><a href="https://learnk8s.io/allocatable-resources">Allocatable memory and CPU in Kubernetes Nodes - learnk8s</a></li>
<li><a href="https://h20195.www2.hpe.com/V2/GetDocument.aspx?docname=a50001963enw">HPE Reference Architecture for delivering insight across all your data with Microsoft SQL Server 2019 Big Data Clusters</a></li>
<li><a href="https://blogs.vmware.com/apps/files/2019/11/Best-Practices-for-Red-Hat-OpenShift-on-the-VMware-SDDC-Final01.pdf">Best Practices for Red Hat OpenShift on the VMware SDDC - VMware</a></li>
<li><a href="https://www.ctl.io/developers/blog/post/kubernetes-bare-metal-servers">Kubernetes on Bare Metal: When Low Network Latency is Key</a></li>
<li><a href="https://www.dellemc.com/resources/en-us/asset/technical-guides-support-information/solutions/h18212-openshift-container-dpg.pdf">Dell EMC Ready Stack for Red Hat OpenShift Container Platform 4.3</a></li>
</ul>







  
  



  


  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/pichuang" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/phil-huang-09b09895" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@pichuang-tw" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="http://speakerdeck.com/pichuang" target="_blank" rel="noopener" title="speakerdeck.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M213.86 296H100a100 100 0 0 1 0-200h132.84a40 40 0 0 1 0 80H98c-26.47 0-26.45 40 0 40h113.82a100 100 0 0 1 0 200H40a40 40 0 0 1 0-80h173.86c26.48 0 26.46-40 0-40zM298 416a120.21 120.21 0 0 0 51.11-80h64.55a19.83 19.83 0 0 0 19.66-20V196a19.83 19.83 0 0 0-19.66-20H296.42a60.77 60.77 0 0 0 0-80h136.93c43.44 0 78.65 35.82 78.65 80v160c0 44.18-35.21 80-78.65 80z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["announce.dismiss", "content.code.copy", "content.code.annotate", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.path", "navigation.sections", "navigation.indexes", "navigation.expand", "navigation.prune", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "header.autohide"], "search": "assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.8e8db93a.min.js"></script>
      
    
  </body>
</html>